machine:
  php:
    version: 5.5.11
general:
  artifacts:
      - "app/reports"

dependencies:
  post:
    - chmod 755 ./app/Console/cake
    - echo "<?php
        class DATABASE_CONFIG {
         public \$default = array(
          'datasource' => 'Database/Mysql',
          'persistent' => false,
          'host' => '127.0.0.1',
          'login' => 'ubuntu',
          'password' => '',
          'database' => 'circle',
          'prefix' => ''
        );
        public \$test = array(
          'datasource' => 'Database/Mysql',
          'persistent' => false,
          'host' => '127.0.0.1',
          'login' => 'ubuntu',
          'password' => '',
          'database' => 'circle_test',
          'prefix' => ''
        );
        }" > app/Config/database.php
    - echo "create database circle" | mysql -u root
    - ./app/Console/cake Migrations.migration run all

test:
  override:
    - ./app/Console/cake test app AllTests
